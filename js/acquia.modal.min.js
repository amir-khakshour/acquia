function acquia_get_modal_size_factor(a){switch(a){case"small":return{width:.5,height:.5};default:case"medium":return{width:.6,height:.6};case"big":return{width:.75,height:.75};case"bigger":return{width:.85,height:.85};case"full":return{width:1,height:1}}}Diamond.Modal=Diamond.Modal||{},Diamond.Modal.openInstance=[],function(a){Diamond.Modal.show=function(b){var c={};b&&"string"==typeof b&&Drupal.settings[b]?a.extend(!0,c,Drupal.settings[b]):b&&a.extend(!0,c,b);var d={modalTheme:"acquiaModalDialog",throbberTheme:"acquiaModalThrobber",animation:"show",animationSpeed:"fast",modalSize:{type:"scale",width:.8,height:.8,addWidth:0,addHeight:0,contentRight:25,contentBottom:45},modalOptions:{opacity:.55,background:"#fff"},callBacks:{beforeSave:function(){},onSave:function(){},onLoad:function(){}}},e={};a.extend(!0,e,d,Drupal.settings.acquiaModalStyle,c),e.scope=c.scope?c.scope:this,Diamond.Modal.currentSettings=e,Diamond.Modal.openInstance.unshift(e),e.instanceNr=Diamond.Modal.openInstance.length,e.namespace="acquiaModal-"+e.instanceNr,e.selector="#"+e.namespace,e.backdropId=e.namespace+"-backdrop",e.backdropSel="#"+e.backdropId,this.modal=a(Drupal.theme(e.modalTheme,e.namespace)),this.backdrop=a("<div />",{id:e.backdropId,"class":"acquia-modal-backdrop",style:"z-index: 990; display: none;"});var f=function(b){var c=b?document:Diamond.Modal.modal;if("scale"==Diamond.Modal.currentSettings.modalSize.type)var d=a(window).width()*Diamond.Modal.currentSettings.modalSize.width,e=a(window).height()*Diamond.Modal.currentSettings.modalSize.height;else var d=Diamond.Modal.currentSettings.modalSize.width,e=Diamond.Modal.currentSettings.modalSize.height;a(".acquia-modal-content",c).css({width:d+Diamond.Modal.currentSettings.modalSize.addWidth+"px",height:e+Diamond.Modal.currentSettings.modalSize.addHeight+"px"})};return f(),"scale"==e.modalSize.type&&a(window).bind("resize",f),a(document).trigger("acquiaAttachBehaviors"),a("span.modal-title",Diamond.Modal.modal).html(Diamond.Modal.currentSettings.loadingText),Diamond.Modal.modalContent(Diamond.Modal.modal,e.modalOptions,e.animation,e.animationSpeed),a(e.selector).find(".modal-content > .inner").html(Drupal.theme(e.throbberTheme)),this},Diamond.Modal.modalContent=function(b,c,d,e){function f(){a(window).unbind("resize",modalContentResize),a("body").unbind("focus",modalEventHandler),a("body").unbind("keypress",modalEventHandler),a(".close").unbind("click",modalContentClose),a("body").unbind("keypress",modalEventEscapeCloseHandler),a(document).trigger("acquiaDetachBehaviors",a(g.selector)),"fadeIn"==d&&(d="fadeOut"),"slideDown"==d&&(d="slideUp"),"show"==d&&(d="hide"),n.hide()[d](e),Diamond.Modal.closeCurrentInstance(),a(g.selector).remove(),a(g.backdropSel).remove()}var g=this.currentSettings;if(d?"fadeIn"!=d&&"slideDown"!=d&&(d="show"):d="show",e||(e="fast"),c=jQuery.extend({position:"absolute",left:"0px",margin:"0px",background:"#000",opacity:".55"},c),c.filter="alpha(opacity="+100*c.opacity+")",self.pageYOffset)var h=self.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)var h=document.documentElement.scrollTop;else if(document.body)var h=document.body.scrollTop;var i=a(document).height()+50,j=(a(document).width(),a(window).height()),k=a(window).width();j>i&&(i=j),this.modal.html(a(b).html()).appendTo("body");var l=g.instanceNr-1,m=999;this.modal.css({margin:30*l,zIndex:m+l+1}),modalEventHandler=function(b){target=null,b?target=b.target:(b=window.event,target=b.srcElement);for(var c=a(target).parents().get(),d=0;d<c.length;++d){var e=a(c[d]).css("position");if("absolute"==e||"fixed"==e)return!0}return a(target).filter("*:visible").parents(g.selector).size()?!0:(a(g.selector)&&a(g.selector).get(0).focus(),!1)},a("body").bind("focus",modalEventHandler),a("body").bind("keypress",modalEventHandler);var n=this.modal.css({top:"-1000px"}),o=h+j/2-n.outerHeight(!1)/2,p=k/2-n.outerWidth(!1)/2,q=n.css({top:o+"px",left:p+"px"}).remove();a("body").append(q),modalContentClose=function(){return f(),!1},a(".close").bind("click",modalContentClose),modalEventEscapeCloseHandler=function(a){return 27==a.keyCode?(f(),!1):void 0},a(document).bind("keydown",modalEventEscapeCloseHandler),modalContentResize=function(){var b=a(document).height(),c=a(document).width(),d=a(window).height(),e=a(window).width();d>b&&(b=d);var f=a(g.selector),i=h+d/2-f.outerHeight(!1)/2,j=e/2-f.outerWidth(!1)/2;a(g.backdropSel).css("height",b+"px").css("width",c+"px").show(),f.css("top",i+"px").css("left",j+"px").show()},a(window).bind("resize",modalContentResize),this.modal.draggable(),this.modal.focus()},Diamond.Modal.unmodalContent=function(b,c,d){var e=Diamond.Modal.currentSettings;if(c)"fadeOut"!=c&&"slideUp"!=c&&(c="show");else var c="show";if(!d)var d="fast";a(window).unbind("resize",modalContentResize),a("body").unbind("focus",modalEventHandler),a("body").unbind("keypress",modalEventHandler),a(".close").unbind("click",modalContentClose),a(document).trigger("AcquiaDetachBehaviors",a("#modalContent")),b.each(function(){"fade"==c?a(e.selector).fadeOut(d,function(){a(e.backdropSel).fadeOut(d,function(){a(this).remove()}),a(this).remove()}):"slide"==c?a(e.selector).slideUp(d,function(){a(e.backdropSel).slideUp(d,function(){a(this).remove()}),a(this).remove()}):(a(e.selector).remove(),a(e.backdropSel).remove())})},Diamond.Modal.dismiss=function(){Diamond.Modal.modal&&Diamond.Modal.unmodalContent(Diamond.Modal.modal),Diamond.Modal.closeCurrentInstance()},Diamond.Modal.closeCurrentInstance=function(){Diamond.Modal.openInstance,Diamond.Modal.currentSettings;Diamond.Modal.openInstance.length>1?(Diamond.Modal.openInstance.shift(),Diamond.Modal.currentSettings=Diamond.Modal.openInstance[0]):1==Diamond.Modal.openInstance.length&&(Diamond.Modal.currentSettings=Diamond.Modal.openInstance[0],Diamond.Modal.openInstance.shift())},Diamond.Modal.clickAjaxCacheLink=function(){return Diamond.Modal.show(Diamond.Modal.getSettings(this)),Diamond.AJAX.clickAJAXCacheLink.apply(this)},Diamond.Modal.clickAjaxLink=function(){return Diamond.Modal.show(Diamond.Modal.getSettings(this)),!1},Diamond.Modal.submitAjaxForm=function(b){var c=a(this),d=c.attr("action");return setTimeout(function(){Diamond.AJAX.ajaxSubmit(c,d)},1),!1},Diamond.Modal.modal_display=function(b,c,d){var e=Diamond.Modal.currentSettings;0==a(e.selector).length&&Diamond.Modal.show(),a(e.selector).find(".modal-title").html(c.title),a("#"+e.namespace+"-content > .inner").html(c.output).scrollTop(0),Drupal.attachBehaviors()},Diamond.Modal.modal_dismiss=function(b){Diamond.Modal.dismiss(),a("link.acquia-temporary-css").remove()},Drupal.theme.prototype.acquiaModalDialog=function(a){var b="",c="";return void 0!=Diamond.Modal.currentSettings.modalSaveBtn&&1==Diamond.Modal.currentSettings.modalSaveBtn&&(c='<a href="#save" class="acquia-modal-save acquia-button button button-primary button-large">',c+=Diamond.Modal.currentSettings.saveBtnText,c+="</a>"),b+='	<div id="'+a+'" style="position:absolute" class="acquia-modal-wrap">',b+='		<div class="acquia-modal-inner">',b+='			<div class="acquia-modal ac-admin fancy-select">',b+='				<div id="'+a+'-header" class="modal-header">',b+='       			<h2 id="modal-title" class="modal-title">&nbsp;</h2>',b+='					<a class="close modal-close" href="#" title="'+Diamond.Modal.currentSettings.closeText+'">',b+='						<span class="admin-icon"></span>',b+="      	 			 </a>",b+="				</div>",b+='      			<div id="'+a+'-content" class="modal-content acquia-modal-content nice-scroll">',b+='      				<div class="inner">',b+="					</div>",b+="				</div>",b+='      			<div id="'+a+'-footer" class="modal-footer">'+c,b+='					<div class="modal-footer-inner">',b+="					</div>",b+="				</div>",b+="			</div>",b+="		</div>",b+="	</div>"},Drupal.theme.prototype.acquiaModalThrobber=function(){var a="";return a+='  <div id="modal-throbber">',a+='    <div class="modal-throbber-wrapper">',a+='<div class="sk-folding-cube">',a+='  <div class="sk-cube1 sk-cube"></div>',a+='  <div class="sk-cube2 sk-cube"></div>',a+='  <div class="sk-cube4 sk-cube"></div>',a+='  <div class="sk-cube3 sk-cube"></div>',a+="</div>",a+="    </div>",a+="  </div>"},Diamond.Modal.getSettings=function(b){var c=a(b).attr("class").match(/acquia-modal-(\S+)/);return c?c[1]:void 0},a(function(){Drupal.ajax.prototype.commands.acquia_modal_display=Diamond.Modal.modal_display,Drupal.ajax.prototype.commands.acquia_modal_dismiss=Diamond.Modal.modal_dismiss,Drupal.ajax.prototype.commands.acquia_modal_loading=Diamond.Modal.modal_loading})}(jQuery),function(a){Drupal.behaviors.acquiaModal={attach:function(b){a(".acquia-modal-save").length>0&&(a(".acquia-modal-save").closest(".acquia-modal-wrap").addClass("save-btn-on").find('input[value="'+Drupal.t("submit")+'"]').css("display","none"),a(".acquia-modal-save").click(function(b){return b.preventDefault(),a(this).closest(".acquia-modal-wrap").find('form input[value="'+Drupal.t("submit")+'"]').trigger("click"),!1})),a("input",b).keypress(function(b){13==b.which&&a(this).closest(".acquia-modal-wrap").find('form input[value="'+Drupal.t("submit")+'"]').trigger("click")}),a("area.acquia-use-modal, a.acquia-use-modal",b).once("acquia-use-modal",function(){var b=a(this);b.click(Diamond.Modal.clickAjaxLink);var c={};b.attr("href")&&(c.url=b.attr("href"),c.event="click",c.progress={type:"throbber"});var d=b.attr("href");Drupal.ajax[d]=new Drupal.ajax(d,this,c)}),a("input.acquia-use-modal, button.acquia-use-modal",b).once("acquia-use-modal",function(){var b=a(this);b.click(Diamond.Modal.clickAjaxLink);var c=this,d={};d.url=Diamond.Modal.findURL(this),d.event="click";var e=b.attr("id");Drupal.ajax[e]=new Drupal.ajax(e,this,d),a("."+a(c).attr("id")+"-url").change(function(){Drupal.ajax[e].options.url=Diamond.Modal.findURL(c)})}),a(".acquia-modal-wrap form",b).once("acquia-use-modal",function(){var b=a(this),c={};c.url=b.attr("action"),c.event="submit",c.progress={type:"throbber"};var d=b.attr("id");Drupal.ajax[d]=new Drupal.ajax(d,this,c),Drupal.ajax[d].form=b,a("input[type=submit], button",this).click(function(b){return Drupal.ajax[d].element=this,this.form.clk=this,void 0==b.bubbles?(a(this.form).trigger("submit"),!1):void 0})}),a(".acquia-close-modal",b).once("acquia-close-modal").click(function(){return Diamond.Modal.dismiss(),!1}),a(".filter-list.wysiwyg",b).once("acquia-filter-list",function(){a(this).closest(".text-format-wrapper").addClass("acquia-wysiwyg-enabled")})}},a(document).on("acquiaAttachBehaviors acquiaDetachBehaviors",function(){a("body").toggleClass("acquia-modal-on")})}(jQuery);